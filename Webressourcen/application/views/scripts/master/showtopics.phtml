<script type = "text/javascript">
function confirmation()
{
    answer = confirm( 'Sind Sie sicher, dass Sie dieses Thema entgültig löschen möchten?');
    if ( answer)
    {
        document.forms['closeTopicForm'].submit();
    }
}
</script>
<?php
    if ( !empty( $this->topicContent))
    {
        echo '<div id = "content">';
        
        echo $this->msg;  //errormessage
        echo '<center><h1>' . $this->topicName . '</h1></center>';
        
        if ( !empty( $this->topicContent))
        {
            /* dropbox with available topicVersion */
            echo '<form name = "versionSelectForm">';
            echo 'Version: <select name="versionSelect" onChange = "window.location=document.versionSelectForm.versionSelect.options[document.versionSelectForm.versionSelect.selectedIndex].value">';
    
            foreach( $this->topicVersionArray as $topicVersion)
            {
                if ( $this->selectedTopicVersion == $topicVersion)
                {
                    echo '<option selected = "selected" value = "showtopics?id=' . $_GET['id'] . '&ver=' . $topicVersion . '">' . $topicVersion . '</option>';
                }
                else
                {
                    echo '<option value = "showtopics?id=' . $_GET['id'] . '&ver=' . $topicVersion . '">' . $topicVersion . '</option>';
                }
            }        
            echo '</form>';
            
            /* button to close the current topic */
            echo '<form id = "closeTopicForm" action = "closetopic" method = "post">';
                echo '<input type = "hidden" name = "topicID" value = "' .  $_GET['id'] . '" />';
                echo '<input type = "button" value = "schließen" onclick = "confirmation()" /></form>';
        
            /* invitebutton, redirectes to the invite-page */
            echo '<form action = "invite" method = "post">';
                echo '<input type = "hidden" name = "topicID" value = "' . $_GET['id'] . '" />';
                echo '<input type = "submit" value = "Einladungen versenden" />';
            echo '</form>';
        
            /* button to edit and create a new topicVersion */
            echo '<form action = "edittopic" method = "get">';
                echo '<input type = "hidden" name = "id" value = "' . $_GET['id'] . '" />';
                echo '<input type = "hidden" name = "ver" value = "' . $_GET['ver'] . '" />';
                echo '<input type = "submit" value = "Inhalt überarbeiten" />';
            echo '</form>';
            
            /* iframe */
            echo $this->topicContent;
        }
        echo '</div>';
        
        /* --- commentpart --- */
        echo '<div id = "comment">';
        
        if ( !empty( $this->commentRowSet))
        {
            echo '<table border = "1">';
            foreach( $this->commentRowSet as $commentRow)
            {
                echo '<tr><td>' . $commentRow['commentDate'] . '</td>';
                echo '<td>' . $commentRow['userName'] . '</td>';
                echo '<td>' . $commentRow['commentText'] . '</td>';
                echo '<td><form action = "deletecomment" method = "post">';
                    echo '<input type = "hidden" name = "topicID" value = "' . $_GET['id'] . '" />';
                    echo '<input type = "hidden" name = "topicVersion" value = "' . $_GET['ver'] . '" />';
                    echo '<input type = "hidden" name = "commentID" value = "' . $commentRow['commentID'] . '" />';
                    echo '<input type = "submit" value = "löschen" />';
                echo '</form></td></tr>';
            }
            echo '</table>';
            
            echo '<form action = "showcomments?id=' . $_GET['id'] . '&ver=' . $this->selectedTopicVersion . '&page=1" method = "post">';
                echo '<input type = "submit" value = "zeige alle" />';
            echo '</form>';
        }
        echo '<p>' . $this->createCommentForm;
        echo '</div>';
    }
?>