<?php/** * @copyright Copyright (c) 2012, {@link http://aksw.org AKSW} * @license http://opensource.org/licenses/gpl-license.php GNU General Public License(GPL) *//** * loades the database table comment */class CommentModel extends Zend_Db_Table_Abstract{    protected $_name = 'comment';			/**		get the Commentar from a version of the topic		@param $option is an array, which includes "topicID","userID","topicVersion", "orderup"(true\false), "number"(number of Comments),"page"		@return $rowset are the "commentText" with the "userName" an "commentDate"	*/	public function getComment($option)	{		//userTopic Database init		$dbuserTopic = new UserTopicModel();				//select the order		if( $option["orderup"])		{			$sort = 'commentDate ASC';		}		else		{			$sort = 'commentDate DESC';		}				//push the data		$where = 'topicID = "'.$option["topicID"].'" AND topicVersion = "'.$option["topicVersion"].'"';		$number = $option["number"]; 									// number of Comments		$offset = ( $number * ($option["page"] - 1)); 				//startpoint when return Comment		$rowset = $this->fetchAll($where,$sort,$number,$offset);		$rowset2;		//select the data and add the userName		foreach($rowset as $row)		{      			$userTopic = array("userID" => $row['userID'],"topicID" => $row['topicID']);			$row2["commentDate"] = $row->commentDate;			$row2["commentText"] = $row->commentText;			$row2["commentID"] = $row->commentID;			$row2["userID"] = $row->userID;                        if ( $row->anonymous)             {                $row2["userName"] = 'Anonymous';            }            else $row2["userName"] = $dbuserTopic->getUserName($userTopic);                        $rowset2[] = $row2;		}				//return the result		return $rowset2;	}		/**		it delete one Comment		@param $commentID : is the ID to delete this Comment	*/	public function deleteComment($commentID)	{		$adapter = $this->getAdapter();		$sure = $adapter->quote($commentID);		$where = "commentID = $sure";		if( empty($where))		{			throw new Exception('empty WHERE-clause transfer');					}		$this->delete($where);	}		/**      * add a new Comment       * @param $content : "userID","topicID","topicVersion","anonymous","commentText"	*/    public function addComment($content)	{		$daten = array('userID' => $content["userID"],						'topicID' => $content["topicID"],						'topicVersion' => $content["topicVersion"],						'anonymous' => $content["anonymous"],						'commentText' => $content["commentText"]);		$this->insert($daten);	}        /** counts the number of comments available for a specific topicID and topicVersion      * @param $topicID is the specific topicID      * @param $topicVersion selected topicVersion      */    public function countComments( $topicID, $topicVersion)    {        $commentNumber = $this->fetchRow( $this->select()   ->from( $this, array('COUNT(*) as commentNumber'))                                                            ->where( 'topicID = ?', $topicID)                                                            ->where( 'topicVersion = ?', $topicVersion));                return $commentNumber['commentNumber'];    }}?>